head(test.clone.segs)
head(test.clone.segs)
head(annotated.fixed.K12.segments)
head(annotated.fixed.K12.segments)
head(annotated.clone.K12.segments)
fixed.K12.segment.plot
annotated.fixed.K12.segments
head(labeled.mutations)
test <- filter(labeled.mutations,lineage=='Ara+1',gene.annotation=='malT')
test
data.frame(test)
levels(test$mut.annotation)
levels(labeled.mutations$mut.annotation)
test2 <- filter(labeled.mutations,mut.annotation=='')
test2
data.frame(test2)
unique(test4$gene.annotation)
unique(test2$gene.annotation)
levels(test$mut.annotation)
levels(labeled.mutations$mut.annotation)
no.B.genomes <- filter(labeled.mutations,lbl!='0')
LTEE.top.hits
data.frame(LTEE.top.hits)
no.B.genomes <- labeled.mutations %>% filter(lbl!=0)
data.frame(LTEE.top.hits)
}
makeFig1panel <- Fig1.factory(labeled.mutations, G.score.data, analysis.type='Fig1')
panel1 <- makeFig1panel(c("Ara+1","Ara+2","Ara+3"))
ggsave("/Users/Rohandinho/Desktop/Fig1A.pdf", panel1,width=9.5,height=8)
makeFig1panel <- Fig1.factory(labeled.mutations, G.score.data, analysis.type='Fig1')
panel1 <- makeFig1panel(c("Ara+1","Ara+2","Ara+3"))
ggsave("/Users/Rohandinho/Desktop/Fig1A.pdf", panel1,width=9.5,height=8)
makeFig1panel <- Fig1.factory(labeled.mutations, G.score.data, analysis.type='Fig1')
panel1 <- makeFig1panel(c("Ara+1","Ara+2","Ara+3"))
ggsave("/Users/Rohandinho/Desktop/Fig1A.pdf", panel1,width=9.5,height=8)
makeFig1panel <- Fig1.factory(labeled.mutations, G.score.data, analysis.type='Fig1')
panel1 <- makeFig1panel(c("Ara+1","Ara+2","Ara+3"))
makeFig1panel <- Fig1.factory(labeled.mutations, G.score.data, analysis.type='Fig1')
panel1 <- makeFig1panel(c("Ara+1","Ara+2","Ara+3"))
ggsave("/Users/Rohandinho/Desktop/Fig1A.pdf", panel1,width=9.5,height=8)
add.odd.chunks
all.odd.chunks
genomes.df <- odd.genomes
test <- calc.indel.change(odd.genomes)
test
test <- filter(test,genome=='REL11735')
test
sum(test$deleted)
sum(test$inserted)
sum(test$inserted-test$deleted)
sum(test$inserted+test$deleted)
test
head(data.frame(test))
hand.annotation
clone.K12.seg.parallelism
data.frame(clone.K12.seg.parallelism)
odd.introgression.scores
odd.introgressed.genes
scored.odd.genomes
data.frame(head(scored.odd.genomes))
introgression.score
odd.introgression.scores
tail(odd.introgression.scores)
head(K12.diff.data)
K12.diff.data
odd.introgression.scores
data.frame(head(K12.diff.data))
K12.diff.data
odd.introgression.scores
odd.genomes
introgression.vs.divergence.data$introgression.score
filter(introgression.vs.divergence.data,is.na(introgression.score))
odd.genomes %>% filter(gene.annotation=='yegZ')
odd.genomes %>% filter(position==2100919)
odd.genomes %>% filter(position==2100919) %>% data.frame()
K12.diff.data
introgression.vs.divergence.data
filter(introgression.vs.divergence.data,is.na(introgression.score))
two.classed.introgression.data
median.introgression.data
erased.evoexp.mutations
test <- erased.evoexp.mutations %>% filter(lineage=='Ara-3')
test
data.frame(test)
evoexp.erased.mutations
data.frame(evoexp.erased.mutations)
evoexp.erased.mutations
makeLCA_Fig1panel <- Fig1.factory(LCA.evoexp.data,G.score.data,analysis.type='evoexpLCA')
LCApanel1 <- makeLCA_Fig1panel(c("Ara+1","Ara+2","Ara+3", "Ara+4", "Ara+5", "Ara+6"))
LCApanel2 <- makeLCA_Fig1panel(c("Ara-1","Ara-2","Ara-3", "Ara-4", "Ara-5", "Ara-6"))
ggsave("/Users/Rohandinho/Desktop/LCA_Fig1A.pdf", LCApanel1,width=9.5,height=8)
ggsave("/Users/Rohandinho/Desktop/LCA_Fig1B.pdf", LCApanel2,width=9.5,height=8)
obs.evoexp.dS
obs.evoexp.dN
non.fixed.evoexp.dS
non.fixed.evoexp.dN
test <- evoexp.labeled.mutations %>% filter(lbl==0)
test
data.frame(head(test))
test <- evoexp.labeled.mutations %>% filter(lbl==4)
data.frame(head(test))
head(evoexp.labeled.mutations)
data.frame(head(evoexp.labeled.mutations))
evoexp.labeled.mutations$frequency
test <- evoexp.labeled.mutations %>% filter(is.na(frequency))
unique(test$lbl)
erased.evoexp.mutations
initial.erasures
fixed.erasures
final.erasures
non.fixed.erasures
data.frame(non.fixed.erasures)
mut.df <- labeled.mutations
lvector <- c("Ara+1","Ara+2","Ara+3")
top.hits
unique(top.hits$gene.annotation)
LTEE.top.hits
unique(LTEE.top.hits$gene.annotation)
unique(LTEE.top.hits$gene.annotation)
 head(no.B.genomes)
analysis.type= 'Fig1'
quartz()
panel
levels(no.B.genomes$lbl)
unique(no.B.genomes$lbl)
test <- viridis(9)
test
palette(test)
levels(no.B.genomes$lbl)
levels(no.B.genomes$lbl)
test <- no.B.genomes %>% filter(lbl %in% c('6','7','8','9'))
test
levels(no.B.genomes$lbl)
head(LTEE.top.hits)
LTEE.top.hits
seq(130,10)
seq(0,130,10)
seq(10,130,10)
seq(10,120,10)
odd.genomes
make_Fig1_panel <- Fig1.factory(odd.genomes, G.score.data, analysis.type='Fig1')
testpanel <- make_Fig1_panel(c("Ara+1","Ara+2","Ara+3","Ara+4","Ara+5","Ara+6","Ara-1","Ara-2","Ara-3","Ara-4","Ara-5","Ara-6"))
mut.df <- odd.genomes
LTEE.top.hits
top.hits
top.hits$gene.annotation
unique(top.hits$gene.annotation)
genes.to.label
genes.to.label
G.score.data
test <- filter(G.score.data,Observed.nonsynonymous.mutation>1)
test
genes.to.label
data.frame(genes.to.label)
mut.df <- odd.genomes
 genes.to.label
top.G.score.genes
top.hit.labels
top.hit.labels
top.hit.labels
top.hit.labels$mut.annotation
levels(top.hit.labels$mut.annotation)
levels(top.hit.labels$mut.annotation)
top.hit.labels
unique(top.hit.labels$gene.annotation)
quartz()
panel
top.hit.labels
panel
top.hit.labels
genes.to.label
top.hit.labels$mut.annotation
top.hit.labels$mut.annotation
top.hit.labels$mut.annotation
top.hit.labels$mut.annotation
unique(top.hit.labels$lbl)
mut.df = LCA.evoexp.data
top.hit.labels
unique(top.hit.labels$mut.annotation)
mut.df = LCA.evoexp.data
levels(no.B.genomes$mut.annotation)
mut.df <- LCA.evoexp.data
levels(top.hit.labels$mut.annotation)
top.hit.labels$mut.annotation
top.hit.labels$mut.annotation
top.hits
levels(top.hits$mut.annotation)
genes.to.label
data.frame(genes.to.label)
levels(no.B.genomes$mut.annotation)
levels(mut.df$mut.annotation)
levels(evoexp.data$mut.annotation)
levels(evoexp.labeled.mutations$mut.annotation)
levels(evoexp.data)
levels(evoexp.data$mut.annotation)
levels(LCA.evoexp.data$mut.annotation)
mut.df <- LCA.evoexp.data$mut.annotation
mut.df <- LCA.evoexp.data
levels(top.hit.labels)
levels(top.hit.labels$mut.annotation)
top.hit.labels$mut.annotation
data.frame(top.hit.labels)
levels(no.B.genomes$lineage)
rev(levels(no.B.genomes$lineage))
levels(evoexp.data$lineage)
levels(evoexp.labeled.mutations$lineage)
levels(labeled.mutations$lineage)
levels(odd.genomes$lineage)
levels(evoexp.data$lineage)
levels(LCA.evoexp.data)
levels(LCA.evoexp.data$lineage)
levels(LCA.evoexp.data)
levels(LCA.evoexp.data$lineage)
levels(odd.genomes$lineage)
mut.df <- odd.genomes
levels(mut.df$lineage)
levels(no.B.genomes$lineage)
quartz()
panel
mut.df <- LCA.evoexp.data
panel
unique(LCA.evoexp.data$lineage)
unique(odd.genomes$lineage)
levels(odd.genomes$lineage)
)
mut.df <- LCA.evoexp.data
levels(no.B.genomes$lineage)
match(no.B.genomes$lineage,levels(lineage))
match(no.B.genomes$lineage,levels(no.B.genomes$lineage))
tail(no.B.genomes)
130-60
LCA.evoexp.data
test <- filter(LCA.evoexp.data,gene.annotation='iclR')
test <- filter(LCA.evoexp.data,gene.annotation=='iclR')
test
data.frame(test)
data.frame(test %>% select(lineage,genome,mut.type,mut.annotation,gene.annotation))
test <- filter(LCA.evoexp.data,position==4202427)
test
data.frame(test)
test <- filter(evoexp.labeled.mutations,position==4202427)
test
data.frame(test)
filter(evoexp.data,position==4202427)
data.frame(head(evoexp.data))
filter(evoexp.data,position=4202427)
filter(evoexp.data,position==4202427)
filter(LCA.evoexp.data,position==4202427)
mut.df <- odd.genomes
unique(no.B.genomes$lineage)
unique(no.B.genomes$y.center)
mut.df <- LCA.evoexp.data
unique(no.B.genomes$y.center)
unique(no.B.genomes$lineage)
head(odd.genomes)
head(even.genomes)
LCA.evoexp.data
test2 <- intersect(clone.intersection,test)
test
clone.intersection
evoexp.clone.intersection
evoexp.clone.union
my.jaccard.index
evoexp.clone.intersection
odd.genomes
clone.intersection
clone.intersection
LCA.evoexp.data
my.jaccard.index
odd.genomes
evoexp.clone.intersection
typeof(odd.genomes$position)
evoexp.clone.intersection$position
integer(evoexp.clone.intersection$position)
odd.introgression.scores
odd.introgressed.genes
scores <- odd.introgression.scores
scores
K12.diff.data
scores
ggsave("/Users/Rohandinho/Desktop/test.pdf",test,height=2.5,width=6)
ggsave("/Users/Rohandinho/Desktop/test.pdf",test,height=2.5,width=6)
ggsave("/Users/Rohandinho/Desktop/test.pdf",test,height=2.5,width=6)
filter(odd.introgression.scores,introgression.score>0)
filter(odd.introgression.scores,introgression.score==0)
odd.introgression.scores
scores
spline(scores)
auxotrophs
hfrs
auxotrophs
text(x,y, expression(paste("A) ",Delta,"stbA::cat"));
text(x,y, expression(paste("A) ",Delta,"stbA::cat"))
)
auxotrophs
Δ
'Δ'
auxotrophs
hand.annotation
?read.csv
hand.annotation
hand.annotation
hand.annotation
Encoding("Hello")
Encoding(hand.annotation$annotation)
Encoding(hand.annotation$annotation[1])
expression(Delta)
hand.annotation
Δ
'Δ'
Encoding("Δ")
hand.annotation
hand.annotation
hand.annotation
hand.annotation
hand.annotation
hand.annotation
hand.annotation
hand.annotation
auxotrophs
warnings()
warnings()
ggsave("/Users/Rohandinho/Desktop/test.pdf",test,height=2.5,width=6,device=cairo_pdf)
library(Cairo)
install.packages('Cairo')
library(Cairo)
ggsave("/Users/Rohandinho/Desktop/test.pdf",test,height=2.5,width=6,device=cairo_pdf)
warnings()
auxotrophs
hand.annotation
install.packages('ggrepel')
warnings()
warnings()
Fig3 <- makeFig3(odd.introgression.scores,auxotrophs,hfrs)
ggsave("/Users/Rohandinho/Desktop/Fig3.pdf",Fig3,height=2.5,width=6)
test <- K12.evoexp.data
filter(test,initial.freq==0)
filter(test,initial.freq==1)
all.odd.chunks
all.odd.chunks
install.packages("cowplot")
warnings
warnings()
library(cowplot)
quartz()
plot_grid(Fig5A, Fig5B, labels = c("A", "B"))
head(clone.F.coverage)
head(evoexp.F.coverage)
head(STLE.clone.F.coverage)
STLE.clone.F.coverage
)
Fig6
Fig6
Fig6
Fig6
Fig6A
Fig6C
Fig6C
Fig6C
Fig6B
Fig6B
STLE.clone.F.coverage
levels(STLE.clone.F.coverage$Strain.Type)
Fig6B
Fig6A
Fig6A
Fig6C
Fig6C
STLE.evoexp.F.coverage
FigureS5
FigS5
FigS5
FigS5
FigS5
FigS5
FigS5
FigS5
FigS5
FigS5
FigS5
FigS5
FigS5
STLE.Fig10.coverage
Fig10
test
test
data.frame(test)
STLE.Fig10.coverage
STLE.Fig10.coverage
test
max(test$Position)
99001/500
test
tail(test)
test[5000:5100,]
testfig
test
testfig
testfig
test
unique(test$Coverage)
test
only.donor.mutations
only.donor.mutations$lbl
library(scales)
show_col(hue_pal()(4))
only.donor.mutations
levels(only.donor.mutations$lbl)
only.donor.mutations
head(data.frame(only.donor.mutations))
only.donor.mutations$lbl
only.donor.mutations$lineage
only.donor.mutations
show_col(hue_pal()(8))
auxotrophs$Donor.strain
only.donor.mutations
only.donor.mutations$Donor.strain
levels(STLE.evoexp.F.coverage$Lineage)
levels(STLE.evoexp.F.coverage$Lineage)
rep('black',12)
c(red,rep('black',12))
c('red',rep('black',12))
FigS5
head(labeled.mutations)
unique(labeled.mutations$genome)
odd.annotated.clone.K12.segments
head(turner.clones)
turner.clones
test <-  filter(turner.clones,lbl='0')
test <-  filter(turner.clones,lbl!='0')
test
levels(test$lineage)
levels(turner.clones$lbl)
mut.df <- turner.clones
levels(no.B.genomes$lbl)
test <- turner.clones %>% filter(lbl=='3')
test
unique(test$gene.annotation)
test <- turner.clones %>% filter(genome=='REL4398')
filter(test,lbl=='4')
data.frame(filter(test,lbl=='4'))
test <- filter(turner.clones,genome=='REL4397')
filter(test,lbl=='4')
data.frame(filter(test,lbl=='4'))
data.frame(filter(turner.clones,genome=='REL4398',lbl=='4'))
mut.df <- turner.clones
top.hit.labels
data.frame(top.hit.labels)
turner.clones
levels(turner.clones$genome)
test1 <- unique(turner.clones$genome)
match(test1,levels(turner.clones$genome))
top.hit.labels
top.hit.labels$lbl
test <- filter(no.B.genomes,lbl=='3')
test
data.frame(test)
levels(top.hit.labels$lbl)
levels(no.B.genomes$lbl)
levels(top.hit.labels$lbl)
levels(no.B.genomes$lbl)
mut.df <- turner.clones
filter(mut.df,lbl=='2')
filter(turner.clones,lbl=='5')
turner.clones$frequency
turner.clones
test
test2
unique(test2$genome)
test
REL4397.diffs
REL4398.diffs
data.frame(REL4397.diffs)
unique(test1$gene.annotation)
unique(test2$gene.annotation)
REL4397.diffs
REL4398.diffs
head(REL4397.data)
head(REL4398.data)
setdiff(REL4397.diffs,REL4398.diffs)
REL4397.diffs
REL4398.diffs
REL4398.diffs %>% filter(mut.annotation == 'indel')
REL4398.diffs %>% filter(mut.annotation == 'indel') %>% data.frame
REL4397.diffs %>% filter(mut.annotation == 'indel') %>% data.frame
REL4397
REL4397.diffs
data.frame(REL4397.diffs)
test1
test2
test1
test2
data.frame(test1)
data.frame(test2)
REL4397.diffs2
REL4397.diffs2
REL4397.diffs2 %>% data.frame
REL4397.diffs
REL4397.diffs %>% data.frame
REL4398.diffs %>% filter(gene.annotation=='lacY')
