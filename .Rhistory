x = 1277
binz
x = 2385739
x/8327
floor(x/8327)
floor(123/8327)
ceil(123/8327)
ceiling(123/8327)
introgression.vs.divergence.data
introgression.vs.divergence.data
FigS1.2
FigS1.2
FigS1.2
s1.2model
confint(s1.2model)
evoexp.data
head(data.table(evoexp.data))
head(data.frame(evoexp.data))
evoexp.data2
max(evoexp.data2$frequency)
max(evoexp.data2$frequency)
evoexp.data2
head(data.frame(evoexp.data2))
evoexp.data2
test
head(data.frame(test))
test
head(data.frame(test))
test
head(data.frame(test))
test2 <- filter(test,lineage=='Ara-3' & position==5627)
test2
test2 <- filter(evoexp.data,lineage=='Ara-3' & position==5627)
test2
data.frame(test2)
test
data.frame(test)
test
evoexp.data2
head(data.frame(test))
head(data.frame(evoexp.data2))
quartz()
cluster.plot2
install.packages("ggfortify")
evoexp.data2
evoexp.fixations
fixed.erasures
erased.evoexp.mutations
erased.evoexp.mutations
unique(erased.evoexp.mutations$gene.annotation)
final.erasures
data.frame(final.erasures)
initial.erasures
quartz()
evoexp.fixations
K12.parallel.evoexp.dS.fixations.by.allele
K12.parallel.evoexp.dN.fixations.by.allele
K12.parallel.evoexp.dN.fixations.by.allele$parallelism
evoexp.fixations
K12.parallel.evoexp.dS.fixations.by.gene
K12.parallel.evoexp.dN.fixations.by.gene
new.parallel.evoexp.dS.fixations.by.gene
new.parallel.evoexp.dN.fixations.by.gene
1031/914
labeled.mutations <- evoexp.data2
evoexp.data2
labeled.mutations
levels(labeled.mutations$lineage)
l1 = "Ara+1"
l2 = "Ara+2"
l3 = "Ara+3"
l4 = "Ara+4"
l5 = "Ara+5"
l6 = "Ara+6"
evoexp.data2
labeled.mutations <- evoexp.data2
evoexp.data2
labeled.mutations <- evoexp.data2
labeled.mutations
no.B.genomes
no.B.genomes$lineage
rev(unique(no.B.genomes$genome))
rev(unique(no.B.genomes$lineage))
test <- evoexp.data2 %>% filter(lineage == 'Ara+5')
test
l5
initial.erasures
final.erasures
fixed.erasures
evoexp.data2 %>% filter(lbl==4)
LCA.evoexp.data
unique(LCA.evoexp.data$lbl)
LCA.evoexp.data
scored.LCA.evoexp.data
scored.LCA.evoexp.data
gene.test
all.genomes
PARAMETERS
amps
head(K12.specific.coverage)
nbinom.fit
nbinom.draws
quartz()
test.plot
install.packages("mixtools")
head(test.dt)
length(test.dt$K12_position)
K12.LENGTH - length(test.dt$K12_position)
test.dt$K12_position
K12.zero.cov.vec
head(test.dt)
test.dt2
test.dt2
zero.K12_position.vec
length(zero.K12_position.vec)
K12.LENGTH - length(test.dt$K12_coverage)
length(test.dt$K12_coverage)
length(test.dt$K12_position)
K12.LENGTH - length(test.dt$K12_position)
head(test.dt2)
test.dt2
head(test.dt2,20)
head(test.dt2,20)
test.plot
test.plot
dotR <- file.path(Sys.getenv("HOME"), ".R")
if (!file.exists(dotR)) dir.create(dotR)
M <- file.path(dotR, "Makevars")
if (!file.exists(M)) file.create(M)
cat("\nCXXFLAGS=-O3 -mtune=native -march=native -Wno-unused-variable -Wno-unused-function", 
    file = M, sep = "\n", append = TRUE)
cat("\nCC=clang", "CXX=clang++ -arch x86_64 -ftemplate-depth-256", 
    file = M, sep = "\n", append = TRUE)
cat(readLines(M), sep = "\n")
cat(M)
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies=TRUE)
fx <- inline::cxxfunction( signature(x = "integer", y = "numeric" ) , '
	return ScalarReal( INTEGER(x)[0] * REAL(y)[0] ) ;
' )
fx( 2L, 5 )
library("rstan")
genome.input.df
amps
amps
data.frame(amps)
amp.parallelism
annotated.amps
names(amps)
genome.input.df
names(genome.input.df)
genome.input.df$Genome
amp.parallelism
amps
data.frame(amps)
my.dt2
nbinom.fit
data
fit <- vb(stan.model, data=data, par=c("pi","mean2","tau2"),
          tol_rel_obj=0.01,algorithm="meanfield")
names(K12.specific.coverage)
levels(K12.specific.coverage$genome)
unique(K12.specific.coverage$genome)
mixed.pop.test.data
quartz()
nbinom.fit
mean2 <- 2*nbinom.fit$mean
mean2
mean1 = 51.9
disp = 2.7
pnbinom(mean2,size=disp,mu=mean1)
pnbinom(mean2,size=disp,mu=mean2)
pnbinom(mean2,size=disp,mu=mean2,lower.tail=FALSE)
pnbinom(mean2,size=disp,mu=mean2,lower.tail=FALSE)
pnbinom(mean2,size=disp,mu=mean1,lower.tail=FALSE)
y = pnbinom(mean2,size=disp,mu=mean1,lower.tail=FALSE)
x = pnbinom(mean2,size=disp,mu=mean1,lower.tail=FALSE)
x
y
y = pnbinom(mean2,size=disp,mu=mean2,lower.tail=FALSE)
y
x
y/x
log(y/x)
y = dnbinom(mean2,size=disp,mu=mean2)
x = dnbinom(mean2,size=disp,mu=mean1)
x
y
dnbinom(mean2,size=disp,mu=mean2)
dnbinom(103,size=disp,mu=mean2)
dnbinom(104,size=disp,mu=mean2)
dnbinom(52,size=disp,mu=mean2)
mean2
dnbinom(52,size=disp,mu=103)
dnbinom(103,size=disp,mu=103)
T1.density.plot
joint.coverage.density.plot
head(K12.specific.coverage)
10 % 2
10 %/% 2
11 %/% 2
11 %% 2
nbinom.fit
nbinom.fit$mean
nbinom.fit$dispersion
qnbinom(0.01,size=nbinom.fit$dispersion,mu=nbinom.fit$mean)
qnbinom(0.05,size=nbinom.fit$dispersion,mu=nbinom.fit$mean)
quartz()
test.plot
test.plot
qnbinom(0.1,size=nbinom.fit$dispersion,mu=nbinom.fit$mean)
test.plot
test.plot
test.plot
test.plot
my.cov.threshold
T0.cov.threshold
T1.cov.threshold
quartz()
quartz()
joint.coverage.scatter.plot
head(K12.specific.coverage)
unique(K12.specific.coverage$genome)
pop.and.clone.metadata
head(K12.specific.coverage)
object_size(K12.specific.coverage)
object_size(K12.specific.coverage)
install.packages("pryr")
head(K12.specific.coverage)
unique(K12.specific.coverage$Name)
K12.specific.coverage <- left_join(K12.specific.coverage,pop.and.clone.metadata,copy=TRUE)
type(K12.specific.coverage)
typeof(K12.specific.coverage)
class(K12.specific.coverage)
K12.specific.coverage <- NULL
head(pop.and.clone.metadata)
K12.mixed.pop.data
K12.mixed.pop.data
K12.mixed.pop.data
K12.mixed.pop.data
tbl_df(K12.mixed.pop.data)
K12.clone.data
K12.mixed.pop.data
test
test
test
test
K12.mixed.pop.data <- filter(K12.specific.data,is.Clone==0,Generation %in% c(1000,1200)) %>%
    group_by(Population,K12_position) %>% summarize(fixed=ifelse(n()==2,TRUE,FALSE)) %>%
    filter(fixed)
K12.clone.data
test1
filtered.cov.subset <- test1
filtered.coverage <- test1
K12.segments
K12.segments
detach(plyr)
detach("plyr")
detach("package:plyr", unload=TRUE)
library(dplyr)
detach("package:ggplot2", unload=TRUE)
detach("package:ggrepel", unload=TRUE)
detach("package:ggplot2", unload=TRUE)
detach("package:viridis", unload=TRUE)
detach("package:dplyr", unload=TRUE)
detach("package:dtplyr", unload=TRUE)
detach("package:dplyr", unload=TRUE)
detach("package:dplyr", unload=TRUE)
detach("package:plyr", unload=TRUE)
K12.mixed.pop.data
fixed.K12.segments
data.frame(fixed.K12.segments)
clone.K12.segments <- K12.clone.data %>% group_by(Name) %>% do(find.K12.segments(.))
K12.clone.data
unique(K12.clone.data$Name)
head(K12.clone.data$Name)
head(K12.clone.data)
clone.K12.segments
clone.K12.segments
K12.gb
annotated.fixed.K12.segments
fixed.K12.segments <- segments
segments <- fixed.K12.segments
ref.gbk <- K12.gb
g.amp.ranges
g.amp.ranges
gb
ref.genes
hits
segment.genes.df
fixed.K12.seg.parallelism
data.frame(fixed.K12.seg.parallelism)
data.frame(clone.K12.seg.parallelism)
annotated.clone.K12.segments
head(annotated.clone.K12.segments)
clone.K12.segments
K12.mixed.pop.data
head(clone.K12.seg.parallelism)
head(annotated.clone.K12.segments)
K12.clone.data
head(K12.clone.data)
is.odd
clone.K12.seg.parallelism
clone.K12.seg.parallelism
fixed.K12.seg.parallelism
annotated.clone.K12.segments
labeled.mutations
recomb.mut.ratio.table
data.frame.recomb.mut.ratio.table
data.frame(recomb.mut.ratio.table)
all.chunk.summary
all.K12.chunks
head(data.frame(all.K12.chunks))
all.K12.chunk.count
recomb.mut.ratio.table
recomb.mut.ratio.table
recomb.mut.ratio.table <- filter(labeled.mutations,mut.annotation=='dS') %>%
    group_by(genome) %>% mutate(recomb.dS=ifelse(lbl %in% c(1,4,6,7,8,9),1,0)) %>%
    mutate(new.dS=ifelse(lbl==3,1,0)) %>%
    summarise(tot.new.dS=sum(new.dS),tot.recomb.dS=sum(recomb.dS)) %>%
    left_join(all.K12.chunk.count) %>%
    mutate(dS.r.over.m.ratio=tot.recomb.dS/tot.new.dS) %>%
    mutate(event.r.over.m.ratio=recombination.events/tot.new.dS)
recomb.mut.ratio.table
data.frame(recomb.mut.ratio.table)
head(evoexp.fixations)
head(K12.diff.data)
all.K12.dN
all.K12.dS
7969/23827
2967/9408
obs.evoexp.dS
obs.evoexp.dN
obs.evoexp.dS
obs.evoexp.dN
44229/143748
obs.evoexp.dS
obs.evoexp.dN
19730/64037
non.fixed.evoexp.dS
non.fixed.evoexp.dN
6726/21551
7969/23827
6726/21551
head(hybrid.search.data)
data.frame(head(hybrid.search.data))
head(hybrid.search.data)
data.frame(head(hybrid.search.data))
hybrid.search.data
data.frame(hybrid.search.data)
install.packages('zoo')
head(hybrid.search.data2)
head(hybrid.search.data)
hybrid.search.data2
hybrid.search.data
data.frame(hybrid.search.data)
hybrid.search.data$replcaed
hybrid.search.data$replaced
test <- hybrid.search.data$replaced
test
rollmean(test,5,na.pad=TRUE)
head(hybrid.search.data3)
hybrid.search.data4
donor.mutations.summary
levels(donor.mutations$genome)
auxotrophs
head(only.donor.mutations)
test
data.frame(test)
test
test
data.frame(test)
head(odd.genome.chunks)
head(test)
data.frame(test)
data.frame(test)
head(test)
head(test$chunk.transitions)
x = 1
x += 1
head(test)
head(test$chunk.index)
tail(test$chunk.index)
test$chunk.index
test.segment.labels <- test$K12.chunk
test.segment.labels
system.time(index.segments(test.segment.labels))
test.lbls <- test$lbl
system.time(labels.to.chunk(test.lbls))
system.time(labels.to.chunks(test.lbls))
system.time(labels.to.chunks(test.lbls))
test.genomes <- group_by(odd.genomes,lineage)
test$chunk.index
test
test
ins.test <- filter(test,mut.type='INS')
ins.test <- filter(test,mut.type=='INS')
del.test <- filter(test,mut.type=='DEL')
del.test
deltest2
instest2
deltest2
instest2
indels
indels
indels
indels
indels
test2
head(data.frame(test2))
groups(test)
groups(c(1,2))
test
head(data.frame(test))
odd.K12.chunks
head(data.frame(odd.K12.chunks))
odd.K12.chunks
odd.K12.chunks$chunk.length
test <- group_by(odd.genoes,lineage) %>%
calc.indel.change() %>%
filter(chunk.transitions!='0') %>%
mutate(chunk.length=position-lag(position))
test <- group_by(odd.genomes,lineage) %>%
calc.indel.change() %>%
filter(chunk.transitions!='0') %>%
mutate(chunk.length=position-lag(position))
test
head(test$chunk.length)
test <- group_by(odd.genomes,lineage) %>% calc.indel.change()
test
head(data.frame(test))
test2 <- filter(data,chunk.transitions!='0')
test2 <- filter(test,chunk.transitions!='0')
test2
head(data.frame(test2))
test2 <- filter(test,chunk.transitions!='0') %>% mutate(chunk.length=position-lag(position))
test2
head(data.frame(test2))
test2$position
test2$position
test2
head(data.frame(test2))
test3 <- mutate(test2,chunk.length=position-lag(position))
head(data.frame(test3))
test3$position
lag(test2$position)
head(data.frame(genome.chunks))
test <- mutate(genome.chunks,chunk.length=position-lag(position))
test
head(data.frame(test))
test <- mutate(genome.chunks,chunk.length=lead(position)-position)
head(data.frame(test))
test <- mutate(genome.chunks,chunk.length=as.numeric(position)-lag(as.numeric(position)))
head(data.frame(test))
type(test$position)
typeof(test$position)
t1 = test$position
t2 = lag(test$position)
t1
t2
t1-t2
genome.chunks
head(data.frame(genome.chunks))
test = head(data.frame(genome.chunks))
test
test %>% mutate(chunk.length=position-lag(position))
test2 <- genome.chunks %>% mutate(chunk.length=position-lag(position))
head(data.frame(test2))
typeof(genome.chunks)
typeof(odd.genomes)
typeof(labeled.mutations)
typeof(labeled.mutations)
labeled.mutations
typeof(labeled.mutations)
typeof(data.frame(labeled.mutations))
odd.genomes
genome.chunks <- group_by(odd.genomes,lineages)
genome.chunks <- group_by(odd.genomes,lineage)
grouped.genomes.df <- genome.chunks
del.sizes
df
head(data.frame(odd.genome.chunks))
head(data.frame(genome.chunks))
test <- genome.chunks
genome.chunks <- test %>% filter(chunk.transitions!='0')
head(data.frame(genome.chunks))
test <- genome.chunks %>%
mutate(chunk.length=position-lag(position))
head(data.frame(test))
class(genome.chunks)
typeof(genome.chunks)
test <- data.frame(genome.chunks) %>% mutate(chunk.length=position-lag(position))
head(test)
class(test)
genome.chunks <- group_by(odd.genomes,lineage) %>%
        calc.indel.change() %>%
        filter(chunk.transitions != '0') %>%
        ## position - lag(position) gives the distance between the previous transition
        ## marker. So, there are N-1 chunk lengths for N markers (first entry is NA).

        data.frame() %>% ## for some reason have to do type coercion to get the lag(position) working.
        mutate(chunk.length=position-lag(position))
genome.chunks
genome.chunks
quote(lineage)
'lineage'
quote(lineage)
head(data.frame(odd.genome.chunks))
head(all.odd.chunks)
all.odd.chunks
levels(all.odd.chunks$lineage)
